<html>

<body>

<div id="page-wrapper">

		<h1>Text File Reader</h1>
		<div>
			Select a text file: 
			<input type="file" id="fileInput">
			button onclick="myFunction()">Enter the Localization</button>
		</div>
		<pre id="fileDisplayArea"><pre>
		
	</div>
	
<script>
	
	window.onload = function() {
		var fileInput = document.getElementById('fileInput');
		var fileDisplayArea = document.getElementById('fileDisplayArea');

		fileInput.addEventListener('change', function(e) {
			var file = fileInput.files[0];
			var textType = /text.*/;

			if (file.type.match(textType)) {
			
				var reader = new FileReader();
				reader.onload = function(e) {
					var words = (function(){
	 
					//split the file contents into separate lines on encountering \R or \r\n or \n
					var fileLines = reader.result.trim().toLowerCase().replace(/[\R\r\n]/g,',').split(/[\,]+/g);
					//console.log("Lines= "+fileLines);
					var fileLinesCount = fileLines.length;
					//console.log("Number of lines="+fileLinesCount);

					//create two new arrays - for score and localization
					var scoreArray = [];
					var localizationArray = [];
					
					//Omit the 1st two lines and start from the 3rd line
					for (var i=2; i<fileLines.length; i++) {
						
						//Separate the line into words on encountering a tab and print each word
						var arrayWords = fileLines[i].replace(/[\t]/g,',').split(/[\,]+/g);
						console.log(arrayWords);
		
							// Array containing protein scores
							scoreArray.push({
							proteinID: arrayWords[0],
							proteinScore: arrayWords[1]
							});
							
							
							// Array containing protein localizations
							localizationArray.push({
							proteinID: arrayWords[0],
							proteinLocalization: arrayWords[2]
							});
						//}
						
					}

					//print the contents of the Score array
					for (var i=0; i<scoreArray.length; i++) {
					var score = scoreArray[i];
					console.log("Protein ID + Score Array  "+score.proteinID, score.proteinScore);
					}
					
					//print the contents of the Localization array
					for (var i=0; i<localizationArray.length; i++) {
						var localization = localizationArray[i];
						console.log("Protein ID + Localization Array  " + localization.proteinID, localization.proteinLocalization);
						}
					
					
					//for one localization type, search for the proteins that are present in that component
					//function myFunction() {
					
					
					var count=0;
					var eukaryotalocalizations = ["chloroplast","chloroplast membrane","cytosol","golgi apparatus","golgi apparatus membrane", 
					"peroxisome","peroxisome membrane","plastid", "plasma membrane", "extra-cellular", "nucleus", "nucleus membrane",
					"vacuole","vacuole membrane","mitochondria","mitochondria membrane","endoplasmic reticulum", "endoplasmic reticulum membrane"];

					var protInCompartmentArray = ["chloroplast","chloroplast membrane","cytosol","golgi apparatus","golgi apparatus membrane", 
"peroxisome","peroxisome membrane","plastid", "plasma membrane", "extra-cellular","nucleus", "nucleus membrane",
"vacuole","vacuole membrane","mitochondria","mitochondria membrane","endoplasmic reticulum", "endoplasmic reticulum membrane"];

					//var text="";
					for(var k =0;k<protInCompartmentArray.length;k++)
					{
								
					console.log("Array created for localizations:  "+ protInCompartmentArray[k]);
					}
					
					for(var i=0;i<localizationArray.length;i++){
					console.log("Keys of localization array = " + localizationArray[i].proteinLocalization);
					for()
					if(localizationArray[i].proteinLocalization in eukaryotalocalizations)
						{
							console.log("True");
							protInCompartmentArray[localizationArray[i].proteinLocalization]=new Array(1,2,3);
							//proteinCount = count[localizationArray[i].proteinLocalization]++;
							//localizationArray[i].proteinLocalization.push({
							//proteinID: localizationArray[i].proteinID
							//});
						}
					}
					for (var i in protInCompartmentArray) {
						for (var j=0 ;j< protInCompartmentArray[i].length; j++) {
						console.log("Protein ID in Localization " + protInCompartmentArray[j][i]);
						
					}
					}
					
					
					/*
					for(var i=0;i<localizationArray.length;i++){
						var exampleLoc = "Nucleus";
						
						if(localizationArray[i].proteinLocalization===exampleLoc.trim().toLowerCase())
						{
							count++;
							protInCompartmentArray.push({
							proteinID: localizationArray[i].proteinID
							});
						}
					} 
														
					for (var i=0; i<protInCompartmentArray.length; i++) {
						var protInConpartment = protInCompartmentArray[i];
						console.log("Protein ID in Localization Nucleus =  " + protInConpartment.proteinID);
					}
					
					console.log("Number of Proteins in " + exampleLoc + " =   " + count);
					*/
					//for one protein type, search for its scores
					//function myFunction() {
					
					var scoreOfProteinArray = [];
					
					for(var i=0;i<scoreArray.length;i++){
						var exampleProt = "sp|Q8SWH2|HSP7A_ENCCU";
						if(scoreArray[i].proteinID===exampleProt.trim().toLowerCase())
						{
							scoreOfProteinArray.push({
							proteinScore: scoreArray[i].proteinScore
							});
						}
					}
					scoreOfProteinArray.sort(function(a,b) {
						return b.proteinScore - a.proteinScore;
					});
					
					for (var i=0; i<scoreOfProteinArray.length; i++) {
						var scoreOfProtein = scoreOfProteinArray[i];
						console.log("Protein score for Protein sp|Q8SWH2|HSP7A_ENCCU =  " + scoreOfProtein.proteinScore);
					}
					
					}());
					
				}			
			reader.readAsText(file);			

			} 
			
			else {
				fileDisplayArea.innerText = "File not supported!"
			}
		});
	}

</script>
</body>
</html>